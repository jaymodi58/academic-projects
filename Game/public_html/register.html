<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <title>myGame</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="game.css" type="text/css">
        <script src="game.js" type="text/javascript"></script>
        <script type="text/javascript">
            function validateData()
            {
                var user_name=document.getElementById("uname").value;
                var first_name=document.getElementById("fname").value;
                var last_name=document.getElementById("lname").value;
                //var password=document.getElementById("password").value;
                var email=document.getElementById("email").value;
                
                if (user_name === "")
                {
                    window.alert("Please enter your User Name.");
                    return false;
                }

                if (first_name === "")
                {
                    window.alert("Please enter your First Name.");
                    return false;
                }
                if (last_name === "")
                {
                    window.alert("Please enter your Last Name.");
                    return false;
                }
                if (email === "")
                {
                    window.alert("Please enter your E-mail address.");
                    return false;
                }

                if (email.indexOf("@", 0) < 0)
                {
                    window.alert("Please enter a valid e-mail address.");
                    return false;
                }

                if (email.indexOf(".", 0) < 0)
                {
                    window.alert("Please enter a valid e-mail address.");
                    return false;
                }
                else
                    return true;
            }
            function add_entry()
            {
                var validatedData=validateData();
                if(validatedData===true)
                {
                    var form_username=document.getElementById("uname").value;
                    var form_password=document.getElementById("password").value;
                    var form_fname=document.getElementById("fname").value;
                    var form_lname=document.getElementById("lname").value;
                    var form_email=document.getElementById("email").value;
                    var form_gender=document.myForm.gender.value;
                    //alert(document.myForm.gender.value);

                    var null_flag=0;
                    if (localStorage.getItem("allEntries") === null)
                    {
                        null_flag=1;//if no object stored in storage
                    }
                    else
                    {
                        var array = JSON.parse(localStorage.getItem('allEntries'));
                        var user_flag=0;

                        for( var i = 0; i < array.length; i++ )
                        {
                            //stored username and password
                            var uname=array[i]["username"];
                            if(uname===form_username)
                            {
                                user_flag=1;
                                alert("Username exists.");
                            }
                        }
                    }
                    if(user_flag===0 || null_flag===1)
                    {
                        // Parse any JSON previously stored in allEntries
                        var existingEntries = JSON.parse(localStorage.getItem("allEntries"));
                        if(existingEntries === null)
                            existingEntries = [];
                        var entry = {
                                    username:form_username,
                                    password: form_password,
                                    fname: form_fname,
                                    lname:form_lname,
                                    email:form_email,
                                    gender:form_gender
                                };
                        localStorage.setItem("entry", JSON.stringify(entry));
                        // Save allEntries back to local storage
                        existingEntries.push(entry);
                        localStorage.setItem("allEntries", JSON.stringify(existingEntries));
                        logout();
                        alert("Registration done successfully.");
                        //alert("Now go to login page.");
                        location.href = "login.html";
                        //window.location="login.html";

                       
                    }//inner if
                }   //outer if
            }//function
        </script>
    </head>
    <body>
        <header>
            Game
        </header>
        <nav>
            <ul>
                <li><a href="index.html">Home</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
                <li><a href="register.html">Register</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
                <li><a href="games.html">Games</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
                <li><a href="logs.html">Logs</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
                <li><a href="charts.html">Charts</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
                <li><a href="login.html">Login</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
            </ul>
        </nav>
        <aside>
            <img id="img" alt="" src="IMG/startpicture.jpg"/>
            <script>
                startTimer();
            </script>
        </aside>
        <article class="others">
            <form name="myForm" id="myform" method="GET">
                <h1>Your Information</h1>
                <table>
                    <tr>
                        <td>Username:</td>
                        <td><input type="text" placeholder="Username" id="uname" required="required"><span>*</span></td>
                    </tr>
                    <tr>
                        <td>First Name:</td>
                        <td><input type="text" placeholder="First Name" id="fname"><span>*</span></td>
                    </tr>
                    <tr>
                        <td>Last Name:</td>
                        <td><input type="text" placeholder="Last Name" id="lname"><span>*</span></td>
                    </tr>
                    <tr>
                        <td>Password:</td>
                        <td><input type="password" placeholder="Password" id="password"><span>*</span></td>
                    </tr>
                    <tr>
                        <td>Email:</td>
                        <td><input type="email" placeholder="abc@xyz.com" id="email"><span>*</span></td>
                    </tr>
                    <tr>
                        <td>Gender:</td>
                        <td>
                            <input type="radio" name="gender" value="male" checked="checked">Male
                            <input type="radio" name="gender" value="female">Female
                        </td>
                    </tr>
                    <tr>
                        <td><input type="button" value="Submit" onclick="add_entry()"></td>
                        <td><input type="reset" value="Cancel" onclick="home()">
                        </td>
                    </tr>
                </table>
            </form>
        </article>
        <footer>
            &copy;2015 Jay Modi. All rights reserved.
        </footer>
    </body>
</html>
